<!DOCTYPE html>
<html>
<title>MPG Calculator</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">

<body>
	<div class="container">

		<div class="form-group">
			<h1>Annual Fuel Cost Calculator</h1>
		</div>

		<div class="form-group">
			<h3>Distance</h3>
			<div class="form-row">
				<div class="form-col">
					<label>Weekly Miles</label>
					<input type="number" id="mi_weekly" name="mi_weekly" min="0" step=".01" placeholder="Miles" onkeyup="cost.distance('mi_weekly')">
				</div>
				<div class="form-col">
					<label>Annual Miles</label>
					<input type="number" id="mi_yearly" name="km_yearly" min="0" step=".01" placeholder="Miles" onkeyup="cost.distance('mi_yearly')">
				</div>
			</div>
			<div class="form-row">
				<div class="form-col">
					<label>Weekly Kilometers</label>
					<input type="number" id="km_weekly" name="km_weekly" min="0" step=".01" placeholder="KM" onkeyup="cost.distance('km_weekly')">
				</div>
				<div class="form-col">
					<label>Annual Kilometers</label>
					<input type="number" id="km_yearly" name="km_yearly" min="0" step=".01" placeholder="KM" onkeyup="cost.distance('km_yearly')">
				</div>
			</div>
		</div>

		<div class="form-group">
			<h3>Fuel Cost</h3>
			<div class="form-row">
				<div class="form-col">
					<label>Gasoline</label>
					<input type="number" id="gas" name="gas" min="0" max="1000" step=".001" placeholder="$ per gallon" onkeyup="cost.gas_price()">
				</div>
				<div class="form-col">
					<label>Electricity</label>
					<input type="number" id="elec" name="elec" min="0" max="1000" step=".001" placeholder="&cent; per kWh" onkeyup="cost.elec_price()">
				</div>
			</div>
		</div>


		<h1>Gasoline Vehicle</h1>
		<div class="form-group table">
			<div class="row">
				<div class="col">Name</div>
				<div class="col">MPG</div>
				<div class="col">Yearly Cost</div>
			</div>
			<div class="row">
				<div class="col"><input type="text" id="F1_name" placeholder="Year Make Model" onkeyup="cost.name('F','1')"></div>
				<div class="col"><input type="number" id="F1_mpg" min="0" step=".01" placeholder="gallons" onkeyup="cost.mpg('1')"></div>
				<div class="col"><input type="text" id="F1_cost" disabled placeholder="$0.00"></div>
			</div>
			<div class="row">
				<div class="col"><input type="text " id="F2_name" placeholder="Year Make Model" onkeyup="cost.name('F','2')"></div>
				<div class="col"><input type="number" id="F2_mpg" min="0" step=".01" placeholder="gallons" onkeyup="cost.mpg('2')"></div>
				<div class="col"><input type="text" id="F2_cost" disabled placeholder="$0.00"></div>
			</div>
			<div class="row">
				<div class="col"><input type="text" id="F3_name" placeholder="Year Make Model" onkeyup="cost.name('F','3')"></div>
				<div class="col"><input type="number" id="F3_mpg" min="0" step=".01" placeholder="gallons" onkeyup="cost.mpg('3')"></div>
				<div class="col"><input type="text" id="F3_cost" disabled placeholder="$0.00"></div>
			</div>
			<div class="row">
				<div class="col"><input type="text" id="F4_name" placeholder="Year Make Model" onkeyup="cost.name('F','4')"></div>
				<div class="col"><input type="number" id="F4_mpg" min="0" step=".01" placeholder="gallons" onkeyup="cost.mpg('4')"></div>
				<div class="col"><input type="text" id="F4_cost" disabled placeholder="$0.00"></div>
			</div>
		</div>

		<h1>Electric Vehicle</h1>
		<div class="form-group table">
			<div class="row">
				<div class="col">Name</div>
				<div class="col">Battery Size</div>
				<div class="col">Range</div>
				<div class="col">Yearly Cost</div>
			</div>
			<div class="row">
				<div class="col"><input type="text" id="E1_name" placeholder="Year Make Model" onkeyup="cost.name('E','1')"></div>
				<div class="col"><input type="number" id="E1_kwh" min="0" step=".01" placeholder="kWh" onkeyup="cost.kwh('1')"></div>
				<div class="col"><input type="number" id="E1_range" min="0" step=".01" placeholder="miles" onkeyup="cost.range('1')"></div>
				<div class="col"><input type="text" id="E1_cost" disabled placeholder="$0.00"></div>
			</div>
			<div class="row">
				<div class="col"><input type="text" id="E2_name" placeholder="Year Make Model" onkeyup="cost.name('E','2')"></div>
				<div class="col"><input type="number" id="E2_kwh" min="0" step=".01" placeholder="kWh" onkeyup="cost.kwh('2')"></div>
				<div class="col"><input type="number" id="E2_range" min="0" step=".01" placeholder="miles" onkeyup="cost.range('2')"></div>
				<div class="col"><input type="text" id="E2_cost" disabled placeholder="$0.00"></div>
			</div>
			<div class="row">
				<div class="col"><input type="text" id="E3_name" placeholder="Year Make Model" onkeyup="cost.name('E','3')"></div>
				<div class="col"><input type="number" id="E3_kwh" min="0" step=".01" placeholder="kWh" onkeyup="cost.kwh('3')"></div>
				<div class="col"><input type="number" id="E3_range" min="0" step=".01" placeholder="miles" onkeyup="cost.range('3')"></div>
				<div class="col"><input type="text" id="E3_cost" disabled placeholder="$0.00"></div>
			</div>
			<div class="row">
				<div class="col"><input type="text" id="E4_name" placeholder="Year Make Model" onkeyup="cost.name('E','4')"></div>
				<div class="col"><input type="number" id="E4_kwh" min="0" step=".01" placeholder="kWh" onkeyup="cost.kwh('4')"></div>
				<div class="col"><input type="number" id="E4_range" min="0" step=".01" placeholder="miles" onkeyup="cost.range('4')"></div>
				<div class="col"><input type="text" id="E4_cost" disabled placeholder="$0.00"></div>
			</div>
		</div>
	</div>

	<script src="js/cookie.js"></script>
	<script type="text/javascript">

		// Global Variables
		var gas_price = cookie.get("gas_price") ? cookie.get("gas_price") : 0;
		var elec_price = cookie.get("elec_price") ? cookie.get("elec_price") : 0;
		var yearly_miles = cookie.get("yearly_miles") ? cookie.get("yearly_miles") : 0;

		// Convert units
		var convert = {
			miles_to_km: function (miles) {
				return (miles * 1.60934).toFixed(2);
			},
			km_to_miles: function (km) {
				return (km / 1.60934).toFixed(2);
			}
		}

		// Calculate Yearly Costs
		var cost = {
			calculate: function () {
				for (let i = 1; i <= 4; i++) {
					cost.mpg(i);
					cost.mpge(i);
				}
			},
			name: function (c, i) {
				if(c=='F') cookie.set("F" + i + "_name", document.getElementById("F" + i + "_name").value);
				if(c=='E') cookie.set("E" + i + "_name", document.getElementById("E" + i + "_name").value);
			},
			mpg: function (i) {
				var mpg = document.getElementById("F" + i + "_mpg").value;
				cookie.set("F" + i + "_mpg", mpg);

				if (Number(mpg) > 0) {
					var yearly_cost = gas_price * yearly_miles / mpg;
					document.getElementById("F" + i + "_cost").value = "$" + (yearly_cost).toFixed(2);
				}
				else {
					document.getElementById("F" + i + "_cost").value = "$0.00";
				}
			},
			mpge: function (i) {
				var kwh = document.getElementById("E" + i + "_kwh").value;
				var range = document.getElementById("E" + i + "_range").value;

				if (Number(kwh) > 0 && Number(range) > 0) {
					var yearly_cost = elec_price * .01 * yearly_miles / (range / kwh);
					document.getElementById("E" + i + "_cost").value = "$" + (yearly_cost).toFixed(2);
				}
				else {
					document.getElementById("E" + i + "_cost").value = "$0.00";
				}
			},
			kwh: function (i) {
				cookie.set("E" + i + "_kwh", document.getElementById("E" + i + "_kwh").value);
				cost.mpge(i);
			},
			range: function (i) {
				cookie.set("E" + i + "_range", document.getElementById("E" + i + "_range").value);
				cost.mpge(i);
			},
			gas_price: function () {
				gas_price = document.getElementById("gas").value;
				cookie.set("gas_price", gas_price);
				cost.calculate();
			},
			elec_price: function () {
				elec_price = document.getElementById("elec").value;
				cookie.set("elec_price", elec_price);
				cost.calculate();
			},
			distance: function (unit) {
				var new_miles = 0;
				if(unit == "mi_weekly") new_miles = document.getElementById("mi_weekly").value * 52;
				if(unit == "mi_yearly") new_miles = document.getElementById("mi_yearly").value;
				if(unit == "km_weekly") new_miles = convert.km_to_miles(document.getElementById("km_weekly").value) * 52;
				if(unit == "km_yearly") new_miles = convert.km_to_miles(document.getElementById("km_yearly").value);

				// Update the global variable
				yearly_miles = new_miles;

				// Calculate the fields
				var mi_weekly = parseFloat((Number)(yearly_miles / 52).toFixed(2));
				var mi_yearly = parseFloat((Number)(yearly_miles).toFixed(2));
				var km_weekly = parseFloat((Number)(convert.miles_to_km(yearly_miles) / 52).toFixed(2));
				var km_yearly = parseFloat((Number)(convert.miles_to_km(yearly_miles)).toFixed(2));

				// Set the fields
				if(unit != "mi_weekly") document.getElementById("mi_weekly").value = mi_weekly;
				if(unit != "mi_yearly") document.getElementById("mi_yearly").value = mi_yearly;
				if(unit != "km_weekly") document.getElementById("km_weekly").value = km_weekly;
				if(unit != "km_yearly") document.getElementById("km_yearly").value = km_yearly;
				
				// Set the cookies
				cookie.set("weekly_miles", mi_weekly);
				cookie.set("yearly_miles", mi_yearly);
				cookie.set("weekly_km", km_weekly);
				cookie.set("yearly_km", km_yearly);

				// Calculate the new yearly costs
				cost.calculate();
			}
		};

		// Initialize the form
		function init(){

			// Load Cookie Data into the form
			for (let i = 1; i <= 4; i++) {
				document.getElementById("F" + i + "_name").value = cookie.get("F" + i + "_name");
				document.getElementById("F" + i + "_mpg").value = cookie.get("F" + i + "_mpg");
				document.getElementById("E" + i + "_name").value = cookie.get("E" + i + "_name");
				document.getElementById("E" + i + "_kwh").value = cookie.get("E" + i + "_kwh");
				document.getElementById("E" + i + "_range").value = cookie.get("E" + i + "_range");
			}
			document.getElementById("mi_weekly").value = cookie.get("weekly_miles");
			document.getElementById("km_weekly").value = cookie.get("weekly_km");
			document.getElementById("mi_yearly").value = cookie.get("yearly_miles");
			document.getElementById("km_yearly").value = cookie.get("yearly_km");
			document.getElementById("gas").value = cookie.get("gas_price");
			document.getElementById("elec").value = cookie.get("elec_price");

			// Calculate the yearly costs
			cost.calculate();
		}
		init();
	</script>

</body>
</html>